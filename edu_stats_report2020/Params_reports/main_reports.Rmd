---
output: 
  officedown::rdocx_document:
   # toc: yes
    tables:
      caption:
        pre: '表 '
    plots:
      caption:
        pre: '图 '

params:
  set_school: "成都三十三中"
  
title: "`r params$set_school`初一学生学习情况学校报告"
date: "`r format(Sys.time(), '%d/%m/%Y')`"
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  fig.showtext = TRUE,
  dpi = 100,
  fig.align = "center",
  # fig.asp = 0.5,
  out.width = "\\textwidth" #' 99%',
  # fig.height = 4,
  # fig.width = 8
)

options(digits = 4)
```


```{r}
library(tidyverse)
library(stringr)
library(readxl)
library(flextable)
library(officer)
library(officedown)

load("../data/myData.Rdata")

source("../_common.R", encoding = "UTF-8")

# cur_schoolname <- "成都三十三中"
cur_schoolname <- params$set_school
```


# 调查概况

核心素养导向和学习科学引领下的教与学势在变革，学校教育重心逐渐从以教师的教为中心转变到以学生的学为中心。这种学习不再仅仅是学生掌握知识与技能的，而是以知识学习为载体，通过更深入的教学过程，引导学生能够活用知识，学会自我学习，发展与他人的交流合作能力。秉着这样的教育价值追求，遵循教育循证研究的要求，借鉴“深度学习研究”（SDL）项目实证研究总结的机会-结果实践行动理论，本次调查主要从学校给学生创设了怎样的学习环境和学习机会和学生学校效果如何两个大的方面入手，对学生在学校的学习情况进行摸底。对于学习环境，依据国际国内学生发展核心素养、深度学习中关注的重点内容，着重调查学习体验、高阶思维、学会学习、交流合作以及学习反馈方式、教学组织形式。对于学校效果，除了关注学业成绩，还调查学生对知识的理解与迁移运用、自我调节的学习、学习情感动力和交流合作。

```{r}
p <- df_sampling %>% dplyr::filter(`学校` == cur_schoolname)
```

本次调查采用网上作答问卷的形式进行，由于处于疫情特殊时期，本次调查的样本数量没有达到预期数量。学校初一学生完成了问卷的学生人数为`r p[["样本数"]]`，占初一总人数的`r p[["比例"]]`。对于学习环境的营造部分，得分率越高表示频率越高。对于学习效果部分，得分率越高表示越符合描述的正向情况，即得分率越高情况越好。



## 调查结果

学习环境的营造主要探究在语文、数学、英语学科课堂教学过程中，教师有没有为学生学习创设能唤起学习兴趣、需要高阶思维参与、支持学习调控、鼓励同伴交流等的环境。



## 学习环境营造指标得分率

```{r tab.cap='学习环境营造指标得分率', tab.id='学习环境营造指标得分率'}
obs_var <- c(
  "t_Practical_experience",
  # "t_Higher_order_thinking",

  "f_Higher_order_thinking_rethink",
  "f_Higher_order_thinking_whole",
  "f_Higher_order_thinking_practice",

  "t_Learn_to_learn",
  "t_Cooperation"
)

df_all %>%
  dplyr::filter(school == cur_schoolname | school == "全区") %>%
  dplyr::select(
    school,
    all_of(obs_var)
  ) %>%
  tidyr::pivot_longer(
    cols = -school,
    names_to = "question",
    values_to = "values"
  ) %>%
  tidyr::pivot_wider(
    names_from = school,
    values_from = values
  ) %>%
  mutate(question = recode(question, !!!labels, .default = NA_character_)) %>%
  relocate(`全区`, .after = "question") %>%
  rename("指标" = question) %>%
  flextable_minbar() %>%
  footnote(
    i = 1,
    j = 3,
    value = as_paragraph(
      c("红色代表高于或等于区平均得分率，蓝色代表低于区平均得分率，下同")
    ),
    ref_symbols = c("a"),
    part = "header",
    inline = T
  )
```



## 学习环境营造各个题目得分率

```{r tab.cap='学习环境营造各个题目得分率', tab.id='学习环境营造各个题目得分率'}
d1 <- d %>%
  stats_option_prop(
    c(content_Practical_experience, content_Higher_order_thinking)
  ) %>%
  dplyr::filter(school == cur_schoolname | school == "金牛区") %>%
  tidyr::pivot_longer(
    cols = -school,
    names_to = "question",
    values_to = "values"
  ) %>%
  tidyr::pivot_wider(
    names_from = school,
    values_from = values
  ) %>%
  rename("题目" = question)

d1 %>% flextable_minbar()
```








## 学习结果指标得分率图
```{r tab.cap='学习结果营造指标得分率', tab.id='学习结果营造指标得分率'}
obs_var <- c(
  "t_Understanding_nature_of_things",
  "t_Understanding_meaning_of_knowledge",
  "t_Application_of_knowledge",
  "t_Learning_planning",
  "t_Learning_strategy",
  "t_Learning_persistence",
  "t_Learning_motivation",
  "t_Learning_confidence",
  "t_Examination_anxiety",
  "t_Exchange_and_share",
  "t_Knowledge_mastery"
)


df_all %>%
  dplyr::filter(school == cur_schoolname | school == "全区") %>%
  dplyr::select(
    school,
    all_of(obs_var)
  ) %>%
  tidyr::pivot_longer(
    cols = -school,
    names_to = "question",
    values_to = "values"
  ) %>%
  tidyr::pivot_wider(
    names_from = school,
    values_from = values
  ) %>%
  mutate(question = recode(question, !!!labels, .default = NA_character_)) %>%
  relocate(`全区`, .after = "question") %>%
  flextable_minbar()
```




## 学习结果各个题目得分率

```{r tab.cap='学习环境营造各个题目得分率', tab.id='学习环境营造各个题目得分率'}
d1 <- d %>%
  stats_option_prop(
    c(
      content_Understanding_nature_of_things,
      content_Understanding_meaning_of_knowledge,
      content_Application_of_knowledge,
      content_Learning_planning,
      content_Learning_strategy,
      content_Learning_persistence,
      content_Learning_motivation,
      content_Learning_confidence,
      content_Examination_anxiety,
      content_Exchange_and_share
    )
  ) %>%
  dplyr::filter(school == cur_schoolname | school == "金牛区") %>%
  tidyr::pivot_longer(
    cols = -school,
    names_to = "question",
    values_to = "values"
  ) %>%
  tidyr::pivot_wider(
    names_from = school,
    values_from = values
  ) %>%
  rename("题目" = question)

d1 %>% flextable_minbar()
```



# 结论与建议

在学习环境营造方面，哪些指标相对较好，哪些指标相对较弱。建议如下：

在学习结果方面，哪些指标相对较好，哪些指标相对较弱。建议如下：
